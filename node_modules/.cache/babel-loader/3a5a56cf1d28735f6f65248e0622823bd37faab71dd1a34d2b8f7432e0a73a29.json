{"ast":null,"code":"// 文件下载服务\nexport const downloadFile = async (filename, displayName = null) => {\n  try {\n    // 构建文件URL，指向uploads目录\n    const fileUrl = `/src/uploads/${encodeURIComponent(filename)}`;\n\n    // 使用fetch获取文件\n    const response = await fetch(fileUrl);\n    if (!response.ok) {\n      throw new Error(`文件不存在或无法访问 (HTTP ${response.status})`);\n    }\n\n    // 获取文件blob\n    const blob = await response.blob();\n\n    // 创建下载链接\n    const url = window.URL.createObjectURL(blob);\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.download = displayName || filename;\n\n    // 设置链接样式，确保不可见\n    link.style.display = \"none\";\n\n    // 触发下载\n    document.body.appendChild(link);\n    link.click();\n\n    // 清理\n    document.body.removeChild(link);\n    window.URL.revokeObjectURL(url);\n    return {\n      success: true,\n      message: \"下载成功\"\n    };\n  } catch (error) {\n    console.error(\"下载失败:\", error);\n    throw new Error(error.message || \"文件下载失败\");\n  }\n};\n\n// 检查文件是否存在\nexport const checkFileExists = async filename => {\n  try {\n    const fileUrl = `/uploads/${encodeURIComponent(filename)}`;\n    const response = await fetch(fileUrl, {\n      method: \"HEAD\"\n    });\n    return response.ok;\n  } catch (error) {\n    return false;\n  }\n};\nexport default {\n  downloadFile,\n  checkFileExists\n};","map":{"version":3,"names":["downloadFile","filename","displayName","fileUrl","encodeURIComponent","response","fetch","ok","Error","status","blob","url","window","URL","createObjectURL","link","document","createElement","href","download","style","display","body","appendChild","click","removeChild","revokeObjectURL","success","message","error","console","checkFileExists","method"],"sources":["D:/tax-centre/tax-centre/src/api/fileService.js"],"sourcesContent":["// 文件下载服务\r\nexport const downloadFile = async (filename, displayName = null) => {\r\n    try {\r\n        // 构建文件URL，指向uploads目录\r\n        const fileUrl = `/src/uploads/${encodeURIComponent(filename)}`\r\n\r\n        // 使用fetch获取文件\r\n        const response = await fetch(fileUrl)\r\n\r\n        if (!response.ok) {\r\n            throw new Error(`文件不存在或无法访问 (HTTP ${response.status})`)\r\n        }\r\n\r\n        // 获取文件blob\r\n        const blob = await response.blob()\r\n\r\n        // 创建下载链接\r\n        const url = window.URL.createObjectURL(blob)\r\n        const link = document.createElement(\"a\")\r\n        link.href = url\r\n        link.download = displayName || filename\r\n\r\n        // 设置链接样式，确保不可见\r\n        link.style.display = \"none\"\r\n\r\n        // 触发下载\r\n        document.body.appendChild(link)\r\n        link.click()\r\n\r\n        // 清理\r\n        document.body.removeChild(link)\r\n        window.URL.revokeObjectURL(url)\r\n\r\n        return { success: true, message: \"下载成功\" }\r\n    } catch (error) {\r\n        console.error(\"下载失败:\", error)\r\n        throw new Error(error.message || \"文件下载失败\")\r\n    }\r\n}\r\n\r\n// 检查文件是否存在\r\nexport const checkFileExists = async (filename) => {\r\n    try {\r\n        const fileUrl = `/uploads/${encodeURIComponent(filename)}`\r\n        const response = await fetch(fileUrl, { method: \"HEAD\" })\r\n        return response.ok\r\n    } catch (error) {\r\n        return false\r\n    }\r\n}\r\n\r\nexport default {\r\n    downloadFile,\r\n    checkFileExists,\r\n}\r\n\r\n"],"mappings":"AAAA;AACA,OAAO,MAAMA,YAAY,GAAG,MAAAA,CAAOC,QAAQ,EAAEC,WAAW,GAAG,IAAI,KAAK;EAChE,IAAI;IACA;IACA,MAAMC,OAAO,GAAG,gBAAgBC,kBAAkB,CAACH,QAAQ,CAAC,EAAE;;IAE9D;IACA,MAAMI,QAAQ,GAAG,MAAMC,KAAK,CAACH,OAAO,CAAC;IAErC,IAAI,CAACE,QAAQ,CAACE,EAAE,EAAE;MACd,MAAM,IAAIC,KAAK,CAAC,oBAAoBH,QAAQ,CAACI,MAAM,GAAG,CAAC;IAC3D;;IAEA;IACA,MAAMC,IAAI,GAAG,MAAML,QAAQ,CAACK,IAAI,CAAC,CAAC;;IAElC;IACA,MAAMC,GAAG,GAAGC,MAAM,CAACC,GAAG,CAACC,eAAe,CAACJ,IAAI,CAAC;IAC5C,MAAMK,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IACxCF,IAAI,CAACG,IAAI,GAAGP,GAAG;IACfI,IAAI,CAACI,QAAQ,GAAGjB,WAAW,IAAID,QAAQ;;IAEvC;IACAc,IAAI,CAACK,KAAK,CAACC,OAAO,GAAG,MAAM;;IAE3B;IACAL,QAAQ,CAACM,IAAI,CAACC,WAAW,CAACR,IAAI,CAAC;IAC/BA,IAAI,CAACS,KAAK,CAAC,CAAC;;IAEZ;IACAR,QAAQ,CAACM,IAAI,CAACG,WAAW,CAACV,IAAI,CAAC;IAC/BH,MAAM,CAACC,GAAG,CAACa,eAAe,CAACf,GAAG,CAAC;IAE/B,OAAO;MAAEgB,OAAO,EAAE,IAAI;MAAEC,OAAO,EAAE;IAAO,CAAC;EAC7C,CAAC,CAAC,OAAOC,KAAK,EAAE;IACZC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK,CAAC;IAC7B,MAAM,IAAIrB,KAAK,CAACqB,KAAK,CAACD,OAAO,IAAI,QAAQ,CAAC;EAC9C;AACJ,CAAC;;AAED;AACA,OAAO,MAAMG,eAAe,GAAG,MAAO9B,QAAQ,IAAK;EAC/C,IAAI;IACA,MAAME,OAAO,GAAG,YAAYC,kBAAkB,CAACH,QAAQ,CAAC,EAAE;IAC1D,MAAMI,QAAQ,GAAG,MAAMC,KAAK,CAACH,OAAO,EAAE;MAAE6B,MAAM,EAAE;IAAO,CAAC,CAAC;IACzD,OAAO3B,QAAQ,CAACE,EAAE;EACtB,CAAC,CAAC,OAAOsB,KAAK,EAAE;IACZ,OAAO,KAAK;EAChB;AACJ,CAAC;AAED,eAAe;EACX7B,YAAY;EACZ+B;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}